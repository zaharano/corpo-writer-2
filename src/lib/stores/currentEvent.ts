// should move this in here, will require some refactoring